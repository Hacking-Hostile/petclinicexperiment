# Multi-Language CI/CD Pipeline - Execution Layer
# This workflow implements ONLY the Execution Layer (Just Commands) from the architecture diagram

name: 03 - Execution Layer

# =============================================================================
# EXECUTION LAYER - Just Commands
# =============================================================================

on:
  workflow_run:
    workflows: ["02 - Orchestration Layer"]
    types: [completed]

jobs:
  just-commands:
    name: ðŸš€ Just Commands Execution
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Java
        uses: actions/setup-java@v4
        with:
          java-version: "17"
          distribution: "temurin"
          cache: maven

      - name: Install Just
        uses: taiki-e/install-action@just

      - name: Run Just Detect
        run: just detect

      - name: Run Just Status
        run: just status

      - name: Run Just Build
        run: just build

      - name: Run Just Test
        run: just test

      - name: Run Just Clean
        run: just clean

      - name: Run Just Maven Validate
        run: just mvn-validate

      - name: Run Just Coverage
        run: just coverage

      - name: Upload artifacts
        uses: actions/upload-artifact@v4
        with:
          name: build-artifacts
          path: |
            target/
            build/
            *.jar

  execution-summary:
    name: ðŸ“Š Execution Summary
    runs-on: ubuntu-latest
    needs: just-commands

    steps:
      - name: Display execution summary
        run: |
          echo "ðŸ“Š EXECUTION LAYER SUMMARY"
          echo "=========================="
          echo "âœ… Just Detect: Completed"
          echo "âœ… Just Status: Completed"
          echo "âœ… Just Build: Completed"
          echo "âœ… Just Test: Completed"
          echo "âœ… Just Clean: Completed"
          echo "âœ… Just Maven Validate: Completed"
          echo "âœ… Just Coverage: Completed"
          echo "âœ… Artifacts Uploaded"
          echo ""
          echo "âœ… Execution Layer completed - ready for Security Layer"
